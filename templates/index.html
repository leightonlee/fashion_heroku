<!DOCTYPE html>
<html>
<head>
    <style type="text/css">
        #container {
            width: 100%;
            margin: auto;
        }

        #container > div {
            border-style: solid;
            border-color: #ff0
            background-color: #fff;
            width: 220px;
            padding: 2px;
        }

        #container > div img {
        padding: 0px;
        display: block;
        }
    </style>
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.3/jquery.min.js"></script>
    <script type="text/javascript" src="{{ url_for('static', filename='js/jquery.pinto.js') }}"></script>
    <script>
    var page = 1
    function createFashionItem(item) {
        var fashion_item = $('<div/>', {
            text:   "Title: " + item.title});
        fashion_item.append("<br>");
        fashion_item.append("Author: " + item.author);
        fashion_item.append("<br>");
        fashion_item.append("Description: " + item.blurb);
        fashion_item.append("<br>");
        fashion_item.append("<img src=/fashion/image/" + item.thumbnail_url + ">");
        fashion_item.append("<br>");
        fashion_item.append("Additional info: <a href=\"" + item.details_url + "\">" + item.details_url + "<a/>");
        return fashion_item;
    }

    function onDataReceived (data) {
        $.each(data.items, function(idx, obj) {
            $("#container").append(createFashionItem(obj));
        });
        console.log("Finished adding items to container");
    };

    function getFashionItems() {
        console.log("Getting fashion page: " + page);
        $.getJSON("/fashion/" + page, onDataReceived);
        console.log("finished getting json")
        page += 1;
        console.log("finished incrementing page")
    }

    $(document).ready(function() {
        getFashionItems();
        $('#container').pinto({});
        $('#container').pinto({});
    });

    $(window).on("scroll", function() {
        var scrollHeight = $(document).height();
        var scrollPosition = $(window).height() + $(window).scrollTop();
        console.log("Scroll Height: " + scrollHeight);
        console.log("Scroll Position: " + scrollPosition);
        if ((scrollHeight == scrollPosition)) {
            console.log("End of page!");
            getFashionItems();
        }
        console.log("Finished Pinto");
        console.log("Finished window scroll");
    });
    </script>
</head>
<body>
<div id="container"></div>

</body>
</html>
